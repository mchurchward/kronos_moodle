YUI.add("moodle-block_rlagent-mass",function(e,t){M.block_rlagent=M.block_rlagent||{},M.block_rlagent={data_actions:{},data_addons:{},plugin_types:{block:{type:"block",title:"Block",icon:"fa-square-o"},mod:{type:"mod",title:"Module",icon:"fa-rocket"},auth:{type:"auth",title:"Authentication",icon:"fa-key"},enrol:{type:"enrol",title:"Enrolment",icon:"fa-group"},filter:{type:"filter",title:"Filter",icon:"fa-filter"},format:{type:"format",title:"Course Format",icon:"fa-columns"},gradeexport:{type:"gradeexport",title:"Grade Export",icon:"fa-download"},local:{type:"local",title:"Local",icon:"fa-home"},qtype:{type:"qtype",title:"Question Type",icon:"fa-check-square-o"},repository:{type:"repository",title:"Repository",icon:"fa-folder-open"},theme:{type:"theme",title:"Theme",icon:"fa-picture-o"},tinymce:{type:"tinymce",title:"TinyMCE",icon:"fa-text-height"},plagiarism:{type:"plagiarism",title:"Plagiarism",icon:"fa-eye"}},plugin_fetch_addons:function(){YUI().use("io-base",function(e){function t(e,t,n){}function n(e,t,n){var r=null;YUI().use("json-parse",function(e){try{r=e.JSON.parse(t.responseText)}catch(n){}}),M.block_rlagent.data_addons=r,M.block_rlagent.plugin_write_addons()}function r(e,t,n){}$url=M.cfg.wwwroot+"/blocks/rlagent/addons.php?type=addonlist",e.on("io:complete",t,e,[]),e.on("io:success",n,e,[]),e.on("io:failure",r,e,["AJAX request failed."]),$addons=e.io($url)})},plugin_write_addons:function(){e.Object.each(M.block_rlagent.data_addons,function(t,n){$displayname=t.display_name,$description=t.description,$rating=t.rating,$type=t.type,$buttonmarkup='<button type="button" class="btn btn-install btn-primary" data-toggle="modal" data-target="#manage_install_modal">',$buttonmarkup+='<i class="fa fa-plus"></i>',$buttonmarkup+="Install",$buttonmarkup+="</button>",$ratingmarkup='<div class="avg-rating"><h5>Average Rating</h5>';for(i=1;i<6;i++)i<=$rating?$ratingmarkup+='<i class="fa fa-star"></i>':$ratingmarkup+='<i class="fa fa-star-o"></i>';$ratingmarkup+="</div>",$itemmarkup='<ul class="media-list"><li class="media">',$itemmarkup+='<i class="pull-left plugin-type fa '+M.block_rlagent.plugin_types[$type].icon+'"></i>',$itemmarkup+='<div class="media-body">',$itemmarkup+='<h3 class="media-heading">'+$displayname+"</h3>",$itemmarkup+="<p>"+$description+"</p>",$itemmarkup+='<div class="rate-plugin">',$itemmarkup+="<p><strong>Add or update your rating</strong> for this plugin.</p>",$itemmarkup+='<i class="fa fa-star-o" title="1 star"></i>',$itemmarkup+='<i class="fa fa-star-o" title="2 stars"></i>',$itemmarkup+='<i class="fa fa-star-o" title="3 stars"></i>',$itemmarkup+='<i class="fa fa-star-o" title="4 stars"></i>',$itemmarkup+='<i class="fa fa-star-o" title="5 stars"></i>',$itemmarkup+="</div>",$itemmarkup+="</div>",$itemmarkup+="</li></ul>",$html='<div class="plugin well type-'+M.block_rlagent.plugin_types[$type].type+'">',$html+='<div class="choose">',$html+=$buttonmarkup,$html+=$ratingmarkup,$html+="</div>",$html+=$itemmarkup,$html+="</div>",e.one(".plugin-select .plugins").insert($html,"after"),M.block_rlagent.plugin_rate_plugins()})},skip_update_init:function(){$button=e.one("#skipupdate"),e.one("#skipupdate").on("click",function(){e.one(".site-update").hide(!0,function(){e.one(".plugin-select").setStyle("display","block").hide().show(!0)}),M.block_rlagent.plugin_select_init()})},update_site_init:function(){e.one("#doupdate").on("click",function(t){t.target.setAttribute("disabled"),e.one(".site-update-spinner").show(!0),$useremail=e.one("#useremail").get("text")})},plugin_select_init:function(){M.block_rlagent.plugin_select_filter(),M.block_rlagent.plugin_clear_filters(),M.block_rlagent.plugin_input_filter(),M.block_rlagent.plugin_dropdown_visibility(),M.block_rlagent.plugin_fetch_addons()},plugin_manage_dropdown:function(){},plugin_add_filter:function(t){$labelsbox=e.one("#labels-box"),$labelsbox.getStyle("display")==="none"&&$labelsbox.setStyle("display","block"),$filters=e.all("#filter-labels span.badge"),$filterlist=$filters.get("text");var n=[];return e.Array.each($filterlist,function(e){n.push(e.trim())}),n.indexOf(t)<=-1?($labelmarkup='<span class="badge">'+t+'<i class="fa fa-times" alt="Remove Filter"></i></span>',$filters.length>=1?$item=$filters.item($filterlist.length-1).insert($labelmarkup,"after"):$item=e.one("#filter-labels").insert($labelmarkup),M.block_rlagent.plugin_filter_plugins(),M.block_rlagent.plugin_remove_filter(),M.block_rlagent.plugin_show_filterblock(),$item):!1},plugin_select_filter:function(){e.all("ul#select-filters li").on("click",function(t){$target=e.one(t.currentTarget),$label=$target.one("a").get("text"),M.block_rlagent.plugin_add_filter($label)})},plugin_dropdown_visibility:function(){$filter_ul=e.one("ul#select-filters"),$filter_li=e.all("ul#select-filters li"),$filter_btn=e.one("#btn-select-filter"),$filter_btn.on("click",function(){$filter_ul.getStyle("display")==="block"?($filter_ul.setStyle("display","none"),$filter_ul.get("parentNode").toggleClass("open")):($filter_ul.setStyle("display","block"),$filter_ul.get("parentNode").toggleClass("open"))}),$filter_li.on("click",function(){$filter_ul.getStyle("display")==="block"?($filter_ul.setStyle("display","none"),$filter_ul.get("parentNode").toggleClass("open")):($filter_ul.setStyle("display","block"),$filter_ul.get("parentNode").toggleClass("open"))})},plugin_input_filter:function(){function t(){$filter=e.one("input#plugin-filter").get("value"),$filter.length>=1&&(M.block_rlagent.plugin_add_filter($filter),$input.set("value","")),M.block_rlagent.plugin_show_filterblock()}$input=e.one("input#plugin-filter"),$inputengaged=!1,$input.on("click",function(){$input.set("value",""),$inputengaged=!0,$input.on("blur",function(){$inputengaged=!1}),$input.on("key",t,"enter")})},plugin_clear_filters:function(){$clearbutton=e.one("button#clear-filters"),$clearbutton.on("click",function(){e.all("#filter-labels span.badge").remove(!0),M.block_rlagent.plugin_filter_plugins(),M.block_rlagent.plugin_hide_filterblock()})
},plugin_show_filterblock:function(){e.all("#filter-labels span.badge").size()>=1&&e.one("#labels-box").show(!0)},plugin_hide_filterblock:function(){e.all("#filter-labels span.badge").size()<=0&&e.one("#labels-box").hide(!0)},plugin_remove_filter:function(){$removebutton=e.all("#filter-labels i.fa-times"),$removebutton.on("click",function(e){$target=e.target.get("parentNode").remove(!0),M.block_rlagent.plugin_hide_filterblock()})},plugin_rate_plugins:function(){e.all(".rate-plugin .fa-star-o, .rate-plugin .fa-star").on("click",function(t){$target=e.one(t.target),$starset=$target.get("parentNode").get("children").filter(".fa"),$clickedindex=$starset.indexOf($target),$fillstars=$starset.slice(0,$clickedindex+1),$emptystars=$starset.slice($clickedindex+1,$starset.size()+1),$rating=$clickedindex+1,$starset.each(function(e){e.hasClass("fa-star-o")&&e.removeClass("fa-star-o"),e.hasClass("fa-star")&&e.removeClass("fa-star"),$starset.indexOf(e)===$starset.size()-1&&($emptystars.addClass("fa-star-o"),$fillstars.addClass("fa-star"),M.block_rlagent.plugin_send_rating($rating))})})},plugin_send_rating:function(e){},plugin_filter_plugins:function(){},init:function(){$updateshown=e.all(".site-update"),$updateshown.length>=1?(M.block_rlagent.skip_update_init(),M.block_rlagent.update_site_init()):M.block_rlagent.plugin_select_init()}}},"@VERSION@",{requires:["base","node","panel","plugin","transition","event","event-delegate"]});
